---
title: "Explore Categorical Variable for Travel Management"
author: "Pankaj Kumar"
date: "2/9/2019"
output: html_document
params: 
  path: 'Analysis/Data/CaseStudy2-data.xlsx'
  echo: FALSE
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plyr)
job_data=readxl::read_excel(params$path)
job_data=job_data[job_data$Over18=='Y',]
draw_weight_graph <- function(job_data, aa) {
  quo_group  <- sym(aa)
  business_travel_grouped_data=dplyr::group_by(job_data, !!quo_group, Attrition) %>%
    dplyr::summarise(count=n())  
  ce =ddply(business_travel_grouped_data , "Attrition" , 
            transform, percentage_weight = count/sum(count))
  graph <- ggplot(ce, aes(x=Attrition, y=percentage_weight, fill= !!quo_group))+
    geom_bar(stat="identity")
  geom_text((aes(label=percentage_weight)))
  graphs =c ( graph, 
  ggplot(job_data, aes(y=!!quo_group, x = Attrition))+ geom_boxplot(), 
  ggplot(job_data, aes(x=!!quo_group, color = Attrition))+ geom_density() ) 
  graph
  
}

draw_box_plot_graph <- function(job_data, aa) {
  quo_group  <- sym(aa)
  ggplot(job_data, aes(y=!!quo_group, x = Attrition))+ geom_boxplot()

}

draw_density_graph <- function(job_data, aa) {
  quo_group  <- sym(aa)
  ggplot(job_data, aes(x=!!quo_group, color = Attrition))+ geom_density() 
}
```


# check impact of different categorical variables  
```{r}
col_names = names(job_data)

for (col_name in col_names){
  print(draw_box_plot_graph( job_data, col_name))
  print(draw_density_graph( job_data, col_name))
  print(draw_weight_graph( job_data, col_name))
}
  
```

